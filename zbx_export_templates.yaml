zabbix_export:
  version: '6.0'
  date: '2023-07-05T14:08:17Z'
  groups:
    - uuid: 861b91b93b6f41c79c82bac5f4e6f57e
      name: 'Check Point'
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    - uuid: f5068e76a735494e837e7187d5de4b2c
      template: 'Check Point FW chassis'
      name: 'Check Point FW chassis'
      description: 'check Point Virtual System eXtension VSX checkpoint'
      templates:
        - name: 'Check Point VSX'
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: a62b3fc904e64beb88b132c88be63009
          name: 'VSX names'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#VSX},1.3.6.1.6.3.16.1.1.1.1]'
          key: 'discovery[{#VSX},1.3.6.1.6.3.16.1.1.1.1]'
          delay: 10m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var jsonData = JSON.parse(value);
                  lenghtOfArray=jsonData.length;
                  
                  var lld = [];
                  
                  for(var el = 0; el < lenghtOfArray; el++) {
                  
                  var row = {};
                  row['{#HOST.HOST}'] = '{$HOST.HOST}';
                  row['{#HOST.IP}'] = '{$HOST.IP}';
                  row['{#COMMUNITY}'] = '{$COMMUNITY}';
                  row["{#VSX}"] = jsonData[el]['{#VSX}'];
                  row["{#VSID}"] = jsonData[el]['{#VSX}'].replace(/[^0-9]+/g, '');
                  lld.push(row);
                  
                  }
                  
                  return JSON.stringify(lld);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Application
              value: raw
        - uuid: ac51c90a9a1a429da08beeac6feb1861
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          delay: 15s
          history: 1w
          tags:
            - tag: Application
              value: Status
          triggers:
            - uuid: 0faa8ac2a5bf4d8fbbecc98a950cc0f1
              expression: 'max(/Check Point FW chassis/icmpping,#3)=0'
              name: 'Unavailable by ICMP ping'
              priority: HIGH
        - uuid: 124588ffab8c4b49935ca7cb682e2499
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          history: 1w
          value_type: FLOAT
          units: '%'
          tags:
            - tag: Application
              value: Status
          triggers:
            - uuid: 402cdec4888444c38629a88397e94245
              expression: 'min(/Check Point FW chassis/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Check Point FW chassis/icmppingloss,5m)<100'
              name: 'High ICMP ping loss'
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/Check Point FW chassis/icmpping,#3)=0'
        - uuid: e4f81dffb7314f5fa38fa3579ac4ce57
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          history: 1w
          value_type: FLOAT
          units: s
          tags:
            - tag: Application
              value: Status
          triggers:
            - uuid: e0bacab7ab724f4abc733f623cfa0cc8
              expression: 'avg(/Check Point FW chassis/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'High ICMP ping response time'
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                - name: 'High ICMP ping loss'
                  expression: 'min(/Check Point FW chassis/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Check Point FW chassis/icmppingloss,5m)<100'
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/Check Point FW chassis/icmpping,#3)=0'
      discovery_rules:
        - uuid: 02b26371783f4c25a852870149f2aa5d
          name: FanState
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2620.1.6.7.8.2.1.2]'
          key: fanSpeedSensorTable
          delay: 1h
          item_prototypes:
            - uuid: fcb4644310ed4cc29b2cae18acef7ce2
              name: 'FanStatus [{#SNMPVALUE}]'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2620.1.6.7.8.2.1.3.{#SNMPINDEX}'
              key: 'fanSpeedSensorValue[{#SNMPVALUE}]'
              delay: '120'
              history: 7d
              units: RPM
              tags:
                - tag: CheckPoint
                - tag: fan
        - uuid: a2b728f0c3834b4ea7139e7b323a83bd
          name: Temperature
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SENSOR},1.3.6.1.4.1.2620.1.6.7.8.1.1.2]'
          key: tempartureSensorTable
          delay: 1h
          item_prototypes:
            - uuid: 191827719ee0465bbaac86ecb0af668f
              name: 'Temperature {#SENSOR} ({#SNMPINDEX})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2620.1.6.7.8.1.1.3.{#SNMPINDEX}'
              key: 'tempertureSensorValue[{#SENSOR},{#SNMPINDEX}]'
              delay: 2m
              history: 7d
              value_type: FLOAT
              tags:
                - tag: CheckPoint
                - tag: temp
              trigger_prototypes:
                - uuid: 17d9dd61ea5a4dccb3cd86c8ee611b21
                  expression: 'min(/Check Point FW chassis/tempertureSensorValue[{#SENSOR},{#SNMPINDEX}],15m) > {$TEMP:"{#SENSOR}"}'
                  name: 'Temperatur is more than {$TEMP:"{#SENSOR}"}'
                  priority: AVERAGE
                  manual_close: 'YES'
        - uuid: 17e5cca87c664047b583fdee091c8023
          name: vsx.names
          type: DEPENDENT
          key: vsx.names
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#VSX}'
                value: '^vsid[0-9]+$'
                formulaid: A
          lifetime: '0'
          host_prototypes:
            - uuid: 398b4f2872684491958b62d49e1a7281
              host: '{#HOST.HOST} {#VSX}'
              name: '{#HOST.HOST} {#VSX}'
              group_links:
                - group:
                    name: 'Check Point'
              templates:
                - name: 'Check Point VSX'
              macros:
                - macro: '{$SNMP_COMMUNITY}'
                  value: '{#COMMUNITY}_{#VSID}'
              custom_interfaces: 'YES'
              interfaces:
                - type: SNMP
                  ip: '{#HOST.IP}'
                  port: '161'
                  details:
                    community: '{#COMMUNITY}_{#VSID}'
              inventory_mode: AUTOMATIC
          master_item:
            key: 'discovery[{#VSX},1.3.6.1.6.3.16.1.1.1.1]'
      macros:
        - macro: '{$TEMP}'
          value: '70'
          description: 'threshold for temperature'
    - uuid: 16778115b5bd484f9b9e555f6beadc4c
      template: 'Check Point VSX'
      name: 'Check Point VSX'
      description: 'check Point Virtual System eXtension VSX checkpoint individual'
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: aef9a825bd814bcd9ce2b054cead6ead
          name: all.interfaces
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]'
          key: all.interfaces
          delay: 1h
          trends: '0'
          value_type: TEXT
          description: 'used for troubleshooting'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: interfaces
              value: json
        - uuid: 2d948269af664f44830acf74cdbfad5d
          name: 'ARP discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ARP},.1.3.6.1.2.1.3.1.1.2]'
          key: arp.discovery
          delay: 10m
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: STR_REPLACE
              parameters:
                - '{#SNMPINDEX}'
                - snmpindex
            - type: STR_REPLACE
              parameters:
                - '{#ARP}'
                - arp
            - type: JAVASCRIPT
              parameters:
                - |
                  var jsonData = JSON.parse(value);
                  lenghtOfArray=jsonData.length;
                  var lld = [];
                  for(var el = 0; el < lenghtOfArray; el++) {
                  var row = {};
                  row["snmpindex"] = jsonData[el]['snmpindex'];
                  row["arp"] = jsonData[el]['arp'];
                  row["ip"] = jsonData[el]['snmpindex'].match(/(\d+\.\d+\.\d+\.\d+)$/gm)[0];
                  lld.push(row);
                  }
                  return JSON.stringify(lld);
          tags:
            - tag: lld
            - tag: raw
        - uuid: 33dfefcff1e748ca906587eb268de611
          name: 'Connection table limit'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.1.25.10.0
          key: fwConnTableLimit
          delay: 2m
          tags:
            - tag: connections
              value: limit
        - uuid: c53823f309004c84906781063adb43dc
          name: 'Firewall Policy Install Time'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.1.25.2.0
          key: fwInstallTime
          delay: 15m
          trends: '0'
          value_type: CHAR
          tags:
            - tag: CheckPoint
          triggers:
            - uuid: ad4e713f793c4dc6ae25aa8705adacc1
              expression: '(last(/Check Point VSX/fwInstallTime,#1)<>last(/Check Point VSX/fwInstallTime,#2))=1'
              name: '{HOST.NAME} Policy installed'
              status: DISABLED
              priority: INFO
        - uuid: 3bc30d72c85642c3a2ef63f8e62c152f
          name: 'Last Install Policy time'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.1.25.2.0
          key: fwInstallTime1
          delay: 10m
          history: 30d
          trends: '0'
          value_type: CHAR
          tags:
            - tag: CheckPoint
        - uuid: fa70da3a2a064539b90ab9c1dd304349
          name: 'Firewall Module State'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.1.1.0
          key: fwModuleState
          delay: 15m
          trends: '0'
          value_type: CHAR
          tags:
            - tag: CheckPoint
        - uuid: 94e0dc2c2a4548c4b3356a0ddc159282
          name: 'Number of current connections'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.1.25.3.0
          key: fwNumConn
          delay: 2m
          tags:
            - tag: connections
              value: current
        - uuid: f6c53ae71ec24d65b1fd5e90590b02d4
          name: 'Policy name'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.1.25.1.0
          key: fwPolicyName
          delay: 10m
          history: 30d
          trends: '0'
          value_type: CHAR
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            - tag: CheckPoint
        - uuid: 36a9e85ff40c4f659eb19b499d2de65a
          name: 'High Availability State'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.5.6.0
          key: haState
          delay: 15m
          trends: '0'
          value_type: CHAR
          tags:
            - tag: CheckPoint
          triggers:
            - uuid: fab34d81de0843ff8689f103fd426a4a
              expression: 'find(/Check Point VSX/haState,,"like","active")=0 and find(/Check Point VSX/haState,,"like","standby")=0'
              name: '{HOST.NAME} HA State not Active/Standby'
              priority: AVERAGE
        - uuid: 76b83a5e5381492fbce460b20cfb7a6f
          name: 'High Availability Mode'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.5.11.0
          key: haWorkMode
          delay: 15m
          trends: '0'
          value_type: CHAR
          tags:
            - tag: CheckPoint
        - uuid: 66c8eebedb39436b99216ecded9b163d
          name: 'Number of network interfaces'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.2.1.0
          key: ifNumber
          delay: 2m
          tags:
            - tag: interfaces
              value: count
        - uuid: 6abede9c043d4fc29ff255900b98024d
          name: 'IPsec tunnels discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SRCIPADDR},.1.3.6.1.4.1.2620.500.9002.1.7,{#NAME},1.3.6.1.4.1.2620.500.9002.1.2,{#COMMUNITY},.1.3.6.1.4.1.2620.500.9002.1.4]'
          key: ipsec.tunnels.discovery
          delay: 10m
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: STR_REPLACE
              parameters:
                - '{#SRCIPADDR}'
                - srcipaddr
            - type: STR_REPLACE
              parameters:
                - '{#SNMPINDEX}'
                - snmpindex
            - type: STR_REPLACE
              parameters:
                - '{#NAME}'
                - name
            - type: STR_REPLACE
              parameters:
                - '{#COMMUNITY}'
                - community
            - type: JAVASCRIPT
              parameters:
                - |
                  var jsonData = JSON.parse(value);
                  lenghtOfArray=jsonData.length;
                  var lld = [];
                  for(var el = 0; el < lenghtOfArray; el++) {
                  var row = {};
                  row["snmpindex"] = jsonData[el]['snmpindex'];
                  row["srcipaddr"] = jsonData[el]['srcipaddr'];
                  row["community"] = jsonData[el]['community'];
                  row["name"] = jsonData[el]['name'];
                  row["ip"] = jsonData[el]['snmpindex'].match(/^(\d+\.\d+\.\d+\.\d+)/gm)[0];
                  lld.push(row);
                  }
                  return JSON.stringify(lld);
          tags:
            - tag: lld
            - tag: raw
        - uuid: c51852a154bc44b28a343cdfcd768cd9
          name: 'Memory Used'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.6.7.4.4.0
          key: memActiveReal64
          delay: 2m
          units: B
          tags:
            - tag: memory
              value: used
          triggers:
            - uuid: 820debbfb41449158c1a4b92fbccda0a
              expression: 'last(/Check Point VSX/memActiveReal64) / last(/Check Point VSX/memActiveReal64) > 1.2'
              name: '{HOST.NAME} Low memory'
              priority: AVERAGE
        - uuid: e40edea4b7c9404d878e0bc6516ee2d5
          name: 'Memory Free'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.6.7.4.5.0
          key: memFreeReal
          delay: 2m
          units: B
          tags:
            - tag: memory
              value: free
        - uuid: 20418dcc76144706adf2ab83311613f7
          name: 'Memory Total'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.6.7.4.3.0
          key: memTotalReal
          delay: 2m
          units: B
          tags:
            - tag: memory
              value: total
        - uuid: 9061147024ae4e0a9e5198e1e1613f36
          name: Manufacturer
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.6.16.9.0
          key: svnApplianceManufacturer
          delay: 1h
          trends: '0'
          value_type: TEXT
          inventory_link: TYPE
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: CheckPoint
        - uuid: 090609aa84b249f39ece678e175e9290
          name: 'Appliance model'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.6.16.7.0
          key: svnApplianceProductName
          delay: 5m
          trends: '0'
          value_type: TEXT
          inventory_link: MODEL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: CheckPoint
        - uuid: 8b3d5b386b574eeb903fef9a5272b7dd
          name: 'Appliance serial number'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.6.16.3.0
          key: svnApplianceSerialNumber
          delay: 5m
          trends: '0'
          value_type: TEXT
          inventory_link: SERIALNO_A
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: CheckPoint
        - uuid: 526dccb982344fc5a77e72571ab28251
          name: 'Product Version'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2620.1.6.4.1.0
          key: svnVersion
          delay: 1h
          trends: '0'
          value_type: CHAR
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: CheckPoint
        - uuid: 4290ce53038743cc98035b4752ec8b3a
          name: 'Device contact details'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.4.0
          key: sysContact
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.'
          inventory_link: CONTACT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: general
        - uuid: 31c78093e6464a4d9732b25513134edb
          name: 'Device description'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.1.0
          key: sysDescr
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'A textual description of the entity.  This value should include the full name and version identification of the system''s hardware type, software operating-system, and networking software.'
          inventory_link: HARDWARE
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: general
        - uuid: ba260a137ec046309cef7472a5489226
          name: 'Device location'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.6.0
          key: sysLocation
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The physical location of this node (e.g., `telephone closet, 3rd floor'').  If the location is unknown, the value is the zero-length string.'
          inventory_link: LOCATION
          tags:
            - tag: general
        - uuid: 2a2894a7695a403d82b17efb93fb5245
          name: 'Device name'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.5.0
          key: sysName
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'An administratively-assigned name for this managed node. By convention, this is the node''s fully-qualified domain name.  If the name is unknown, the value is the zero-length string.'
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: general
        - uuid: 72b5393fa82548c199161f9f8b39976a
          name: 'CPU: CPU utilization'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CPU.UTIL},1.3.6.1.2.1.25.3.3.1.2]'
          key: system.cpu.util
          history: 7d
          value_type: FLOAT
          units: '%'
          description: |
            MIB: HOST-RESOURCES-MIB
            The average, over the last minute, of the percentage of time that processors was not idle.
            Implementations may approximate this one minute smoothing period if necessary.
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$..[''{#CPU.UTIL}''].avg()'
          tags:
            - tag: component
              value: cpu
          triggers:
            - uuid: 75d07d1d142e4b89854142ce4aa6daf7
              expression: 'min(/Check Point VSX/system.cpu.util,5m)>{$CPU.UTIL.CRIT}'
              name: 'CPU: High CPU utilization'
              event_name: 'CPU: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'The CPU utilization is too high. The system might be slow to respond.'
              tags:
                - tag: scope
                  value: performance
        - uuid: a13d28fbce7e4c6bac3d372cfd669e4d
          name: 'Device uptime'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.3.0
          key: sysUpTime
          history: 7d
          units: uptime
          description: 'The time since the network management portion of the system was last re-initialized.'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: general
        - uuid: bb79ccf0d916427cbd73372554762104
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          tags:
            - tag: Status
          triggers:
            - uuid: a186345830c9404881de6c6b7b3c1db4
              expression: 'max(/Check Point VSX/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'No SNMP data collection, appliance is down'
              priority: HIGH
              manual_close: 'YES'
      discovery_rules:
        - uuid: efd620d1d4274a30a5ac1ea29cfd1795
          name: 'ARP mapping'
          type: DEPENDENT
          key: arp.mapping
          delay: '0'
          item_prototypes:
            - uuid: 3707334f05514d9eb855dc8cf11d2d50
              name: 'ARP {#IP}'
              type: DEPENDENT
              key: 'arp[{#IP}]'
              delay: '0'
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$..[?(@.snmpindex == "{#SNMPINDEX}")].arp.first()'
                  error_handler: DISCARD_VALUE
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 8h
              master_item:
                key: arp.discovery
              tags:
                - tag: arp
          master_item:
            key: arp.discovery
          lld_macro_paths:
            - lld_macro: '{#IP}'
              path: '$.[''ip'']'
            - lld_macro: '{#SNMPINDEX}'
              path: '$.[''snmpindex'']'
        - uuid: 08c9b08d82b24e40bee19fc982a5a59f
          name: 'FW Interfaces Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#FWIFNAME},.1.3.6.1.4.1.2620.1.1.25.5.1.2]'
          key: fwIfName.dicovery
          delay: 1h
          item_prototypes:
            - uuid: 3cbd610713ab47f6b9053575c52273aa
              name: 'Interface {#FWIFNAME} fwAcceptBytesIn'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.1.25.5.1.7.{#SNMPINDEX}'
              key: 'fwAcceptBytesIn["{#FWIFNAME}"]'
              delay: 2m
              value_type: FLOAT
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: AcceptBytes
                  value: In
            - uuid: 9dc176935fc14c6a9dca5367b0a7e56b
              name: 'Interface {#FWIFNAME} fwAcceptBytesOut'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.1.25.5.1.8.{#SNMPINDEX}'
              key: 'fwAcceptBytesOut["{#FWIFNAME}"]'
              delay: 2m
              value_type: FLOAT
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: AcceptBytes
                  value: Out
            - uuid: c08ccc177c5b4a74b73578825362f3c1
              name: 'Interface {#FWIFNAME} fwAcceptPcktsIn'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.1.25.5.1.5.{#SNMPINDEX}'
              key: 'fwAcceptPcktsIn["{#FWIFNAME}"]'
              delay: 2m
              value_type: FLOAT
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: AcceptPckts
                  value: In
            - uuid: 7c16195a18804da2b6eee5e5d856cdad
              name: 'Interface {#FWIFNAME} fwAcceptPcktsOut'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.1.25.5.1.6.{#SNMPINDEX}'
              key: 'fwAcceptPcktsOut["{#FWIFNAME}"]'
              delay: 2m
              value_type: FLOAT
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: AcceptPckts
                  value: Out
            - uuid: a959aaec56544c24beb27429316cf312
              name: 'Interface {#FWIFNAME}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.1.25.5.1.9.{#SNMPINDEX}'
              key: 'fwDropPcktsIn["{#FWIFNAME}"]'
              delay: 2m
              value_type: FLOAT
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: DropPckts
                  value: In
            - uuid: 23e07e1265bd4b199906ba0411fa25d4
              name: 'Interface {#FWIFNAME} fw'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.1.25.5.1.10.{#SNMPINDEX}'
              key: 'fwDropPcktsOut["{#FWIFNAME}"]'
              delay: 2m
              value_type: FLOAT
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: DropPckts
                  value: Out
            - uuid: 9862991c74da4068af156df8f6771a0e
              name: 'Interface {#FWIFNAME}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.1.25.5.1.11.{#SNMPINDEX}'
              key: 'fwRejectPcktsIn["{#FWIFNAME}"]'
              delay: 2m
              value_type: FLOAT
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: RejectPckts
                  value: In
            - uuid: 3e9b16147cdc499589e142cec246c7bb
              name: 'Interface {#FWIFNAME} fw'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.1.25.5.1.12.{#SNMPINDEX}'
              key: 'fwRejectPcktsOut["{#FWIFNAME}"]'
              delay: 2m
              value_type: FLOAT
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: RejectPckts
                  value: Out
          graph_prototypes:
            - uuid: ed3e586cabc64172b56a9baa59c7534a
              name: 'Filtering for interface {#FWIFNAME}'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 00AA00
                  yaxisside: RIGHT
                  item:
                    host: 'Check Point VSX'
                    key: 'fwAcceptBytesIn["{#FWIFNAME}"]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 9999FF
                  yaxisside: RIGHT
                  item:
                    host: 'Check Point VSX'
                    key: 'fwAcceptBytesOut["{#FWIFNAME}"]'
                - sortorder: '2'
                  drawtype: BOLD_LINE
                  color: 00AAAA
                  item:
                    host: 'Check Point VSX'
                    key: 'fwAcceptPcktsIn["{#FWIFNAME}"]'
                - sortorder: '3'
                  color: C8C800
                  item:
                    host: 'Check Point VSX'
                    key: 'fwAcceptPcktsOut["{#FWIFNAME}"]'
                - sortorder: '4'
                  drawtype: BOLD_LINE
                  color: CC0000
                  item:
                    host: 'Check Point VSX'
                    key: 'fwDropPcktsIn["{#FWIFNAME}"]'
                - sortorder: '5'
                  color: C8C8C8
                  item:
                    host: 'Check Point VSX'
                    key: 'fwDropPcktsOut["{#FWIFNAME}"]'
                - sortorder: '6'
                  drawtype: BOLD_LINE
                  color: '666666'
                  item:
                    host: 'Check Point VSX'
                    key: 'fwRejectPcktsIn["{#FWIFNAME}"]'
                - sortorder: '7'
                  color: '960000'
                  item:
                    host: 'Check Point VSX'
                    key: 'fwRejectPcktsOut["{#FWIFNAME}"]'
        - uuid: c18ff209b05c4ecd850a363d3a71faf4
          name: 'HA Status'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.2620.1.5.13.1.2]'
          key: haProblemName
          delay: 1h
          item_prototypes:
            - uuid: 77592be2cabc462e879524e8291f81e6
              name: 'HA Problem Status [{#SNMPVALUE}]'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.5.13.1.3.{#SNMPINDEX}'
              key: 'haProblemStatus[{#SNMPVALUE}]'
              delay: '120'
              trends: '0'
              value_type: TEXT
              tags:
                - tag: CheckPoint
                  value: HA
              trigger_prototypes:
                - uuid: 340f05375ccb4395988d8929f99006df
                  expression: 'find(/Check Point VSX/haProblemStatus[{#SNMPVALUE}],,"like","OK")=0'
                  name: 'HA Status [{#SNMPVALUE}]'
                  priority: AVERAGE
        - uuid: 683d7333d9c648dda0fa159ee88fd4f0
          name: 'IPsec discovery'
          type: DEPENDENT
          key: ipsec.discovery
          delay: '0'
          item_prototypes:
            - uuid: d3d03b140b014983a114a923475166be
              name: 'tunnelState {#NAME}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.500.9002.1.3.{#IP}.0'
              key: 'tunnelState[{#NAME}]'
              description: '{#COMMUNITY}'
              valuemap:
                name: tunnelState
              tags:
                - tag: tunnel
                  value: state
              trigger_prototypes:
                - uuid: 7b9f23dd2aa248ebb55f4aba6bb19842
                  expression: 'count(/Check Point VSX/tunnelState[{#NAME}],#3,"ne","3")>2'
                  name: 'Tunnel {#NAME} ({#IP}) is not active'
                  priority: AVERAGE
                  manual_close: 'YES'
          master_item:
            key: ipsec.tunnels.discovery
          lld_macro_paths:
            - lld_macro: '{#COMMUNITY}'
              path: '$.[''community'']'
            - lld_macro: '{#IP}'
              path: '$.[''ip'']'
            - lld_macro: '{#NAME}'
              path: '$.[''name'']'
        - uuid: 4b7818b00add4e31bb79aee10cc060d7
          name: 'Processor Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.2620.1.6.7.5.1.1]'
          key: multiProc
          delay: 1h
          item_prototypes:
            - uuid: 14b148423e9147409a8307a2e7d23c46
              name: 'Processor [{#SNMPVALUE}] Idle Time'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.6.7.5.1.4.{#SNMPINDEX}'
              key: 'multiProcIdleTime[{#SNMPVALUE}]'
              delay: '90'
              tags:
                - tag: cpu
                  value: idle
              trigger_prototypes:
                - uuid: f76b251c7e8145b2b80e759d5d35b7ab
                  expression: 'avg(/Check Point VSX/multiProcIdleTime[{#SNMPVALUE}],300s)<10'
                  name: '{HOST.NAME} Processor usage higher than 90% on CPU {#SNMPVALUE}'
                  priority: AVERAGE
            - uuid: 6e0df28c92ea46278ae921897b9aedab
              name: 'Processor [{#SNMPVALUE}] System Time'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.6.7.5.1.3.{#SNMPINDEX}'
              key: 'multiProcSystemTime[{#SNMPVALUE}]'
              delay: '90'
              tags:
                - tag: cpu
                  value: system
            - uuid: a4036bc894ca4c5fbba8ad98aa0e2e3e
              name: 'Processor [{#SNMPVALUE}] User Time'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.1.6.7.5.1.2.{#SNMPINDEX}'
              key: 'multiProcUserTime[{#SNMPVALUE}]'
              delay: '90'
              tags:
                - tag: cpu
                  value: user
          graph_prototypes:
            - uuid: d454e98a0f44467e8795a8621cb102a5
              name: 'Processor usage CPU {#SNMPVALUE}'
              show_triggers: 'NO'
              type: STACKED
              graph_items:
                - drawtype: FILLED_REGION
                  color: CC0000
                  item:
                    host: 'Check Point VSX'
                    key: 'multiProcSystemTime[{#SNMPVALUE}]'
                - sortorder: '1'
                  drawtype: FILLED_REGION
                  color: 0000C8
                  item:
                    host: 'Check Point VSX'
                    key: 'multiProcUserTime[{#SNMPVALUE}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 00C800
                  item:
                    host: 'Check Point VSX'
                    key: 'multiProcIdleTime[{#SNMPVALUE}]'
        - uuid: 972ea4b9288e4bb0b2703f952a07c962
          name: 'Network interfaces discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]'
          key: net.if.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
                formulaid: A
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
                formulaid: I
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: J
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: G
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: H
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.MATCHES}'
                formulaid: E
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
                formulaid: C
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.MATCHES}'
                formulaid: K
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: L
          description: 'Discovering interfaces from IF-MIB.'
          item_prototypes:
            - uuid: e2c4ebfc70134258bab5e6f8e381a5db
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 863b3f799c654d0e8ef8acaeb2a451fd
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 1f2c82e0ece94344a7d064b1bc854b26
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 387d327bf8e2451f897abf7464e55695
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: df21a4afbdac4300aa7221368eb3299c
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 5336dbe698d94b45bb252ae435d6352a
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: b280a0ab95bc40e3af0c00287f2c929a
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n' then the speed of the interface is somewhere in the range of `n-500,000' to`n+499,999'.  For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth. For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: d499ee8eebea46a99acdc00633661fe9
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 3e0ea900a46f41dcb84f836c4f63c42a
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the operations status is down.
                    2. `{$IFCONTROL:"{#IFNAME}"}=1` - a user can redefine context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.
                    3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the operational status was up to (1) sometime before (so, do not fire for the 'eternal off' interfaces.)
                    
                    WARNING: if closed manually - it will not fire again on the next poll, because of .diff.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 6e45683038ba4988947847267fb1c562
              name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}'
              key: 'net.if.type[ifType.{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The type of interface.
                Additional values for ifType are assigned by the Internet Assigned Numbers Authority (IANA),
                through updating the syntax of the IANAifType textual convention.
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            - uuid: 1b9ec6b9779d4f93b130a02309467fe0
              expression: |
                change(/Check Point VSX/net.if.speed[ifHighSpeed.{#SNMPINDEX}])<0 and last(/Check Point VSX/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
                and (
                last(/Check Point VSX/net.if.type[ifType.{#SNMPINDEX}])=6 or
                last(/Check Point VSX/net.if.type[ifType.{#SNMPINDEX}])=7 or
                last(/Check Point VSX/net.if.type[ifType.{#SNMPINDEX}])=11 or
                last(/Check Point VSX/net.if.type[ifType.{#SNMPINDEX}])=62 or
                last(/Check Point VSX/net.if.type[ifType.{#SNMPINDEX}])=69 or
                last(/Check Point VSX/net.if.type[ifType.{#SNMPINDEX}])=117
                )
                and
                (last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (change(/Check Point VSX/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and last(/Check Point VSX/net.if.speed[ifHighSpeed.{#SNMPINDEX}],#2)>0) or
                (last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}])=2)
              name: 'Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: 965d03b435cf4a0ca645be98d40b4797
              expression: |
                (avg(/Check Point VSX/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Check Point VSX/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/Check Point VSX/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Check Point VSX/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/Check Point VSX/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Check Point VSX/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Check Point VSX/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/Check Point VSX/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Check Point VSX/net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage'
              event_name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The utilization of the network interface is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: c1522f25c0ef4a3f935bb3fbe14496c8
              expression: |
                min(/Check Point VSX/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Check Point VSX/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Check Point VSX/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Check Point VSX/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Interface {#IFNAME}({#IFALIAS}): High error rate'
              event_name: 'Interface {#IFNAME}({#IFALIAS}): High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'It recovers when it is below 80% of the `{$IF.ERRORS.WARN:"{#IFNAME}"}` threshold.'
              manual_close: 'YES'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Check Point VSX/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: 7e6b2c7a0dce488b86782d4a489961fa
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'Check Point VSX'
                    key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
                - sortorder: '1'
                  drawtype: BOLD_LINE
                  color: F63100
                  item:
                    host: 'Check Point VSX'
                    key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
                - sortorder: '2'
                  color: 00611C
                  yaxisside: RIGHT
                  item:
                    host: 'Check Point VSX'
                    key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
                - sortorder: '3'
                  color: F7941D
                  yaxisside: RIGHT
                  item:
                    host: 'Check Point VSX'
                    key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
                - sortorder: '4'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'Check Point VSX'
                    key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
                - sortorder: '5'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'Check Point VSX'
                    key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
        - uuid: 5b5ff88053f9486590c59e88e42dfa0e
          name: 'Storage discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#FSNAME},1.3.6.1.2.1.25.2.3.1.3,{#FSTYPE},1.3.6.1.2.1.25.2.3.1.2,{#ALLOC_UNITS},1.3.6.1.2.1.25.2.3.1.4]'
          key: 'vfs.fs.discovery[snmp]'
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.MATCHES}'
                formulaid: C
              - macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.MATCHES}'
                formulaid: A
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'HOST-RESOURCES-MIB::hrStorage discovery with storage filter.'
          item_prototypes:
            - uuid: 956850451f0b44e9b7c2f8668935146a
              name: '{#FSNAME}: Space utilization'
              type: CALCULATED
              key: 'vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              params: '(last(//vfs.fs.used[hrStorageUsed.{#SNMPINDEX}])/last(//vfs.fs.total[hrStorageSize.{#SNMPINDEX}]))*100'
              description: 'The space utilization expressed in % for {#FSNAME}.'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
            - uuid: 536fdc75f0934e66be7eb44b0abe1797
              name: '{#FSNAME}: Total space'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.25.2.3.1.5.{#SNMPINDEX}'
              key: 'vfs.fs.total[hrStorageSize.{#SNMPINDEX}]'
              history: 7d
              units: B
              description: |
                MIB: HOST-RESOURCES-MIB
                The size of the storage represented by this entry, in units of hrStorageAllocationUnits.
                This object is writable to allow remote configuration of the size of the storage area in those cases where such an operation makes sense and is possible on the underlying system.
                For example, the amount of main storage allocated to a buffer pool might be modified or the amount of disk space allocated to virtual storage might be modified.
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '{#ALLOC_UNITS}'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
            - uuid: 43b1d55c95514dddba818e3ae608aeee
              name: '{#FSNAME}: Used space'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}'
              key: 'vfs.fs.used[hrStorageUsed.{#SNMPINDEX}]'
              history: 7d
              units: B
              description: |
                MIB: HOST-RESOURCES-MIB
                The amount of the storage represented by this entry that is allocated, in units of hrStorageAllocationUnits.
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '{#ALLOC_UNITS}'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
          trigger_prototypes:
            - uuid: ec3cd45539cc48b3b1ed7aec47b41b56
              expression: |
                last(/Check Point VSX/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}])>{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"} and
                ((last(/Check Point VSX/vfs.fs.total[hrStorageSize.{#SNMPINDEX}])-last(/Check Point VSX/vfs.fs.used[hrStorageUsed.{#SNMPINDEX}]))<{$VFS.FS.FREE.MIN.CRIT:"{#FSNAME}"} or timeleft(/Check Point VSX/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}],1h,100)<1d)
              name: '{#FSNAME}: Disk space is critically low'
              event_name: '{#FSNAME}: Disk space is critically low (used > {$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}%)'
              opdata: 'Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})'
              priority: AVERAGE
              description: |
                Two conditions should match:
                1. The first condition - utilization of the space should be above `{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}`.
                2. The second condition should be one of the following:
                - the disk free space is less than `{$VFS.FS.FREE.MIN.CRIT:"{#FSNAME}"}`;
                - the disk will be full in less than 24 hours.
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: capacity
            - uuid: 799e63ed45a843aa9233d8adeabd2065
              expression: |
                last(/Check Point VSX/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}])>{$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"} and
                ((last(/Check Point VSX/vfs.fs.total[hrStorageSize.{#SNMPINDEX}])-last(/Check Point VSX/vfs.fs.used[hrStorageUsed.{#SNMPINDEX}]))<{$VFS.FS.FREE.MIN.WARN:"{#FSNAME}"} or timeleft(/Check Point VSX/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}],1h,100)<1d)
              name: '{#FSNAME}: Disk space is low'
              event_name: '{#FSNAME}: Disk space is low (used > {$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}%)'
              opdata: 'Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})'
              priority: WARNING
              description: |
                Two conditions should match:
                1. The first condition - utilization of the space should be above `{$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}`.
                2. The second condition should be one of the following:
                - the disk free space is less than `{$VFS.FS.FREE.MIN.WARN:"{#FSNAME}"}`;
                - the disk will be full in less than 24 hours.
              manual_close: 'YES'
              dependencies:
                - name: '{#FSNAME}: Disk space is critically low'
                  expression: |
                    last(/Check Point VSX/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}])>{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"} and
                    ((last(/Check Point VSX/vfs.fs.total[hrStorageSize.{#SNMPINDEX}])-last(/Check Point VSX/vfs.fs.used[hrStorageUsed.{#SNMPINDEX}]))<{$VFS.FS.FREE.MIN.CRIT:"{#FSNAME}"} or timeleft(/Check Point VSX/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}],1h,100)<1d)
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: capacity
          graph_prototypes:
            - uuid: f87158aa24e849fba0c4cf2426541a27
              name: '{#FSNAME}: Disk space usage'
              width: '600'
              height: '340'
              show_work_period: 'NO'
              show_triggers: 'NO'
              graph_items:
                - color: '969696'
                  calc_fnc: ALL
                  item:
                    host: 'Check Point VSX'
                    key: 'vfs.fs.total[hrStorageSize.{#SNMPINDEX}]'
                - sortorder: '1'
                  color: C80000
                  calc_fnc: ALL
                  item:
                    host: 'Check Point VSX'
                    key: 'vfs.fs.used[hrStorageUsed.{#SNMPINDEX}]'
        - uuid: b86023c9226d4ec2a357be3b615f6344
          name: 'Memory discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#MEMNAME},1.3.6.1.2.1.25.2.3.1.3,{#MEMTYPE},1.3.6.1.2.1.25.2.3.1.2,{#ALLOC_UNITS},1.3.6.1.2.1.25.2.3.1.4]'
          key: vm.memory.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#MEMTYPE}'
                value: '{$MEMORY.TYPE.MATCHES}'
                formulaid: C
              - macro: '{#MEMTYPE}'
                value: '{$MEMORY.TYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#MEMNAME}'
                value: '{$MEMORY.NAME.MATCHES}'
                formulaid: A
              - macro: '{#MEMNAME}'
                value: '{$MEMORY.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'HOST-RESOURCES-MIB::hrStorage discovery with memory filter'
          item_prototypes:
            - uuid: 7b9577f3670144aeb42f4724e033be83
              name: '{#MEMNAME}: Total memory'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.25.2.3.1.5.{#SNMPINDEX}'
              key: 'vm.memory.total[hrStorageSize.{#SNMPINDEX}]'
              history: 7d
              units: B
              description: |
                MIB: HOST-RESOURCES-MIB
                The size of the storage represented by this entry, in units of hrStorageAllocationUnits.
                This object is writable to allow remote configuration of the size of the storage area in those cases where such an operation makes sense and is possible on the underlying system.
                For example, the amount of main memory allocated to a buffer pool might be modified or the amount of disk space allocated to virtual memory might be modified.
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '{#ALLOC_UNITS}'
              tags:
                - tag: component
                  value: memory
            - uuid: 626a504047ae4f65b5c0abdc5859bca9
              name: '{#MEMNAME}: Used memory'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}'
              key: 'vm.memory.used[hrStorageUsed.{#SNMPINDEX}]'
              history: 7d
              units: B
              description: |
                MIB: HOST-RESOURCES-MIB
                The amount of the storage represented by this entry that is allocated, in units of hrStorageAllocationUnits.
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '{#ALLOC_UNITS}'
              tags:
                - tag: component
                  value: memory
            - uuid: 49686bbfd19c407e8e8b071d16e467e9
              name: '{#MEMNAME}: Memory utilization'
              type: CALCULATED
              key: 'vm.memory.util[memoryUsedPercentage.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              params: 'last(//vm.memory.used[hrStorageUsed.{#SNMPINDEX}])/last(//vm.memory.total[hrStorageSize.{#SNMPINDEX}])*100'
              description: 'Memory utilization in %.'
              tags:
                - tag: component
                  value: memory
              trigger_prototypes:
                - uuid: 80b27c7129274593a4245e8169859818
                  expression: 'min(/Check Point VSX/vm.memory.util[memoryUsedPercentage.{#SNMPINDEX}],5m)>{$MEMORY.UTIL.MAX}'
                  name: '{#MEMNAME}: High memory utilization'
                  event_name: '{#MEMNAME}: High memory utilization (>{$MEMORY.UTIL.MAX}% for 5m)'
                  priority: AVERAGE
                  description: 'The system is running out of free memory.'
                  tags:
                    - tag: scope
                      value: capacity
                    - tag: scope
                      value: performance
          graph_prototypes:
            - uuid: 2d20ef229da14c899cfb11e5d7b59603
              name: '{#MEMNAME}: Memory utilization'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'Check Point VSX'
                    key: 'vm.memory.util[memoryUsedPercentage.{#SNMPINDEX}]'
      macros:
        - macro: '{$CPU.UTIL.CRIT}'
          value: '90'
        - macro: '{$IF.ERRORS.WARN}'
          value: '2'
        - macro: '{$IF.UTIL.MAX}'
          value: '90'
        - macro: '{$IFCONTROL}'
          value: '1'
        - macro: '{$MEMORY.NAME.MATCHES}'
          value: '.*'
        - macro: '{$MEMORY.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$MEMORY.TYPE.MATCHES}'
          value: '.*(\.2|hrStorageRam)$'
        - macro: '{$MEMORY.TYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$MEMORY.UTIL.MAX}'
          value: '90'
        - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
        - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
        - macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
        - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
        - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '^.*$'
        - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
        - macro: '{$NET.IF.IFTYPE.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
        - macro: '{$UPDT:lld}'
          value: 5m
        - macro: '{$VFS.FS.FREE.MIN.CRIT}'
          value: 5G
        - macro: '{$VFS.FS.FREE.MIN.WARN}'
          value: 10G
        - macro: '{$VFS.FS.FSNAME.MATCHES}'
          value: .+
        - macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
          value: ^(/dev|/sys|/run|/proc|.+/shm$)
        - macro: '{$VFS.FS.FSTYPE.MATCHES}'
          value: '.*(\.4|\.9|hrStorageFixedDisk|hrStorageFlashMemory)$'
        - macro: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$VFS.FS.PUSED.MAX.CRIT}'
          value: '90'
        - macro: '{$VFS.FS.PUSED.MAX.WARN}'
          value: '80'
      valuemaps:
        - uuid: f374ebd9552d464aa4b312d7651c6597
          name: tunnelState
          mappings:
            - value: '3'
              newvalue: active
            - value: '4'
              newvalue: destroy
            - value: '129'
              newvalue: idle
            - value: '130'
              newvalue: phase1
            - value: '131'
              newvalue: down
            - value: '132'
              newvalue: init
  triggers:
    - uuid: c9ea9dd3b4d949a88c268463e6426327
      expression: '(last(/Check Point VSX/haWorkMode,#1)<>last(/Check Point VSX/haWorkMode,#2))=1 or (last(/Check Point VSX/haState,#1)<>last(/Check Point VSX/haState,#2))=1'
      name: '{HOST.NAME} HA State Change'
      priority: WARNING
  graphs:
    - uuid: c6f783cb9d5e4a70ba070a347c2293c6
      name: Connections
      ymin_type_1: FIXED
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Check Point VSX'
            key: fwConnTableLimit
        - sortorder: '1'
          color: FF0000
          calc_fnc: ALL
          item:
            host: 'Check Point VSX'
            key: fwNumConn
    - uuid: 9637e821bf7f46178e85c1a65f591a4f
      name: 'CPU: CPU utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          item:
            host: 'Check Point VSX'
            key: system.cpu.util
